name: Package

on: [pull_request]
# on:
#    milestone:
#      types: [closed]

jobs:
 windows_build:
    name: 'Windows Build'
    runs-on: 'windows-latest'
    steps:
    - uses: actions/checkout@master
      with:
        submodules: true
    - name: Configure Nuget
      run: ((Get-Content -path nuget.config -Raw) -replace 'GITHUB_TOKEN','${{ secrets.GITHUB_TOKEN }}') | Set-Content -Path nuget.config
    - name: Build and Package
      run: dotnet build -c Release --version-suffix ("${{ github.sha }}".Substring(0,7))
    - name: Push
      run: dotnet nuget push src/ElectionGuard/bin/Release/*.nupkg --source "github"